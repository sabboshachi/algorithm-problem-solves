<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>2140. BitMazeCraft @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=1&amp;num=2140"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=1&amp;num=2140&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=1&amp;num=2140&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style58.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=1&amp;num=2140&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=1&amp;num=2140&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">2140. BitMazeCraft</H2><DIV class="problem_limits">Time limit: 3.0 second<BR>Memory limit: 256 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Vlad is a very responsible employee. But instead of working he plays <i>BitMazeCraft</i>. But not the survival mode, he prefers completing user-created maps. As you might guess, it’s very difficult. Especially when Vlad’s co-workers interrupt him constantly.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Today Vlad is trying to complete a map of size <i>A</i> &times; <i>B</i> &times; <i>H</i>, where <i>H</i> is the map’s height. He needs to move the character from one spot to another without leaving the map’s boundaries. The map consists of 1&times; 1&times; 1 cubes, each cube has coordinates (<i>x</i>, <i>y</i>, <i>z</i>) and is either occupied by a wall or empty (1 &le; <i>x</i> &le; <i>A</i>, 1 &le; <i>y</i> &le; <i>B</i>, 1 &le; <i>z</i> &le; <i>H</i>). Vlad is a bit anxious about his boss showing up, so he wants to complete the map as soon as possible. To &ldquo;complete the map&rdquo; means to move the character from start to finish.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Let’s say that a cell is located <i>above the floor</i> if either it’s <i>z</i> coordinate is equal to 1 or the cube below it is occupied. The controls in <i>BitMazeCraft</i> are simple: the character has size 1&times; 1&times; 1 and it must be located in an empty cell above the floor at all times. The character has four types of movement, every one takes up the same amount of time.
<ul>
<li> moving horizontally into a neighboring cell ((<i>x</i>, <i>y</i>, <i>z</i>)<i>→</i>{(<i>x</i>, <i>y</i> <i>±</i> 1, <i>z</i>), (<i>x</i><i>±</i> 1, <i>y</i>, <i>z</i>)}) if the target cell is empty and above the floor (such movement is called <i>walk</i>)
<li> moving horizontally over the neighboring cell ((<i>x</i>, <i>y</i>, <i>z</i>)<i>→</i>{(<i>x</i>, <i>y</i> <i>±</i> 2, <i>z</i>), (<i>x</i> <i>±</i> 2, <i>y</i>, <i>z</i>)}) if both cells in the direction of movement are empty; the cell character passes over ({(<i>x</i>, <i>y</i> <i>±</i> 1, <i>z</i>&minus;1), (<i>x</i><i>±</i> 1, <i>y</i>, <i>z</i>&minus;1)}) is empty (otherwise the character would tumble); and the target cell is above the floor (such movement is called <i>jump</i>)
<li> descent by one layer while moving into a neighboring cell laterally ((<i>x</i>, <i>y</i>, <i>z</i>)<i>→</i>{(<i>x</i>, <i>y</i> <i>±</i> 1, <i>z</i>&minus;1), (<i>x</i><i>±</i> 1, <i>y</i>, <i>z</i>&minus;1)}) if the target cell is empty and above the floor; and the cell above the target cell is also empty (such movement is called <i>drop</i>)
<li> ascent by one layer while moving into a neighboring cell laterally ((<i>x</i>, <i>y</i>, <i>z</i>)<i>→</i>{(<i>x</i>, <i>y</i> <i>±</i> 1, <i>z</i>+1), (<i>x</i> <i>±</i> 1, <i>y</i>, <i>z</i>+1)}) if the cell above the starting cell is within the bounaries of the map and empty; and the target cell is empty and above the floor (such movement is called <i>climb</i>).
</ul></DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">In fact, Vlad isn’t even sure if the map can be completed at all. So he asked you to check if the map can be completed, and if that’s true, what’s the fastest way to get from start to finish.</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The first line contains three space-separated integer numbers <i>A</i>, <i>B</i>, <i>H</i>&nbsp;&mdash; length, width and height of the map (1 &le; <i>A</i>, <i>B</i>, <i>H</i> &le; 50). Then, <i>H</i> &middot; <i>A</i> lines of length <i>B</i> grouped into <i>H</i> blocks with <i>A</i> lines each are given.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Each block describles the slice of the map with a fixed <i>z</i> coordinate. They are given <b>from bottom to top</b>, in the ascending order of <i>z</i>. Each line describes a slice of a block with a fixed <i>x</i> coordinate, lines within a block are given in ascending order of <i>x</i>. Characters in a line describe cells and are given in ascending order of <i>y</i>. Character &ldquo;#&rdquo; (code 35) denotes an occupied cell, character &ldquo;.&rdquo; (code 46) denotes an empty cell.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The last two lines contain three space-separated integers each&nbsp;&mdash; starting point of the characted <i>x</i><sub><i>from</i></sub>, <i>y</i><sub><i>from</i></sub>, <i>z</i><sub><i>from</i></sub> and the destination point <i>x</i><sub><i>to</i></sub>, <i>y</i><sub><i>to</i></sub>, <i>z</i><sub><i>to</i></sub> respectively (1 &le; <i>x</i><sub><i>from</i></sub>, <i>x</i><sub><i>to</i></sub> &le; <i>A</i>, 1 &le; <i>y</i><sub><i>from</i></sub>, <i>y</i><sub><i>to</i></sub> &le; <i>B</i>, 1 &le; <i>z</i><sub><i>from</i></sub>, <i>z</i><sub><i>to</i></sub> &le; <i>H</i>).</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">It is guaranteed that both the starting cell and the destination cell are empty and are above the floor.</DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">If it’s impossible to complete the map, output &ldquo;<code>NO</code>&rdquo; (without quotes) in a single line.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Otherwise, output &ldquo;<code>YES</code>&rdquo; (without quotes) in the first line. In the second line, output an integer <i>N</i>&nbsp;&mdash; the minimal amount of moves to complete the level. In each of next <i>N</i> lines, output the moves in the following format:
<i>type</i><sub><i>i</i></sub>&nbsp;<i>direction</i><sub><i>i</i></sub>,
where <i>type</i><sub><i>i</i></sub> is the type of movement &ldquo;<code>walk</code>&rdquo;, &ldquo;<code>jump</code>&rdquo;, &ldquo;<code>drop</code>&rdquo; or &ldquo;<code>climb</code>&rdquo; (without quotes); <i>direction</i><sub><i>i</i></sub>&nbsp;&mdash; the direction of movement &ldquo;<code>north</code>&rdquo;, &ldquo;<code>east</code>&rdquo;, &ldquo;<code>south</code>&rdquo; or &ldquo;<code>west</code>&rdquo; (without quotes): <code>north</code>&nbsp;&mdash; moving from (<i>x</i>, <i>y</i>, <i>z</i>) to (<i>x</i> &minus; <i>k</i>, <i>y</i>, <i>z</i>'), <code>east</code>&nbsp;&mdash; from (<i>x</i>, <i>y</i>, <i>z</i>) to (<i>x</i>, <i>y</i>+<i>k</i>, <i>z</i>'), <code>south</code>&nbsp;&mdash; from (<i>x</i>, <i>y</i>, <i>z</i>) to (<i>x</i>+<i>k</i>, <i>y</i>, <i>z</i>') or <code>west</code>&nbsp;&mdash; from (<i>x</i>, <i>y</i>, <i>z</i>) to (<i>x</i>, <i>y</i>&minus;<i>k</i>, <i>z</i>'); where <i>k</i> is equal to 2 if <i>type</i><sub><i>i</i></sub> is <code>jump</code> and 1 otherwise; <i>z</i>' equals to <i>z</i> if <i>type</i><sub><i>i</i></sub> is <code>walk</code> or <code>jump</code>, <i>z</i> &minus; 1 if <i>type</i><sub><i>i</i></sub> is <code>drop</code> and <i>z</i> + 1 if <i>type</i><sub><i>i</i></sub> is <code>climb</code>.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">If there are many optimal ways to complete the map, you may output any one of them.</DIV></DIV><H3 CLASS="problem_subtitle">Samples</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>1 2 1
..
1 1 1
1 2 1
</PRE></TD><TD><PRE>YES
1
walk east
</PRE></TD></TR><TR><TD><PRE>3 4 2
.#..
....
.#..
....
....
....
1 1 1
3 4 1
</PRE></TD><TD><PRE>YES
4
climb east
jump south
drop east
walk east
</PRE></TD></TR></TABLE><DIV CLASS="problem_source"><B>Problem Author: </B>Vadim Barinov<BR></DIV></DIV></DIV><DIV><B>Tags: </B><A HREF="problemset.aspx?space=1&amp;tag=graphs">graph theory</A>  <SPAN CLASS="problem_tags_toggle">(<FORM METHOD="POST" ACTION="problem.aspx?space=1&amp;num=2140" STYLE="display:inline;" ID="ToggleTagsForm"><A HREF="problem.aspx?space=1&amp;num=2140" ONCLICK="document.getElementById('ToggleTagsForm').submit();return false;"><INPUT TYPE="hidden" NAME="Action" VALUE="HideTags">hide tags for unsolved problems</A></FORM>)</SPAN></DIV><DIV CLASS="problem_links"><SPAN>Difficulty: 881</SPAN>    <A HREF="print.aspx?space=1&amp;num=2140" TARGET="_blank">Printable version</A>    <A HREF="submit.aspx?space=1&amp;num=2140">Submit solution</A>    <A HREF="forum/?space=1&amp;num=2140">Discussion (0)</A><BR><A HREF="status.aspx?space=1&amp;num=2140">All submissions (206)</A>    <A HREF="status.aspx?space=1&amp;num=2140&amp;status=accepted">All accepted submissions (71)</A>    <A HREF="rating.aspx?space=1&amp;num=2140">Solutions rating (57)</A></DIV></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2020 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>