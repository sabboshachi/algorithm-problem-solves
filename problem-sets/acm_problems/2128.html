<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=utf-8"><META NAME="viewport" CONTENT="width=768"><META HTTP-EQUIV="X-UA-Compatible" CONTENT="IE=edge"><TITLE>2128. Rubina's Solitaire @ Timus Online Judge</TITLE><LINK REL="alternate" HREFLANG="x-default" HREF="/problem.aspx?space=1&amp;num=2128"><LINK REL="alternate" HREFLANG="en-us" HREF="/problem.aspx?space=1&amp;num=2128&amp;locale=en"><LINK REL="alternate" HREFLANG="ru-ru" HREF="/problem.aspx?space=1&amp;num=2128&amp;locale=ru"><LINK REL="stylesheet" TYPE="text/css" HREF="/style58.css"><LINK REL="shortcut icon" TYPE="image/x-icon" HREF="/favicon.ico"></HEAD><BODY><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="body"><TR><TD CLASS="caption"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" CLASS="locale"><A HREF="/problem.aspx?space=1&amp;num=2128&amp;locale=en">ENG</A>&nbsp;&nbsp;<A HREF="/problem.aspx?space=1&amp;num=2128&amp;locale=ru">RUS</A></TD><TD CLASS="title"><A HREF="/">Timus Online Judge</A></TD><TD WIDTH="130"></TD></TR></TABLE></TD></TR><TR><TD CLASS="panel"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="130" VALIGN="TOP" ALIGN="CENTER" STYLE="padding-bottom:5px;"><A HREF="/"><IMG BORDER="0" SRC="/images/usu-summer.jpg" HEIGHT="134" WIDTH="106" ALT=""></A></TD><TD VALIGN="TOP" ALIGN="LEFT"><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="0" CLASS="panel"><TR><TH WIDTH="25%"><DIV>Online Judge</DIV></TH><TH WIDTH="25%"><DIV>Problems</DIV></TH><TH WIDTH="25%"><DIV>Authors</DIV></TH><TH WIDTH="25%"><DIV>Online contests</DIV></TH></TR><TR><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/">About Online Judge</A><BR><A HREF="/help.aspx?topic=faq">Frequently asked questions</A><BR><A HREF="/news.aspx">Site news</A><BR><A HREF="/forum/">Webboard</A><BR><A HREF="/help.aspx?topic=links">Links</A><BR></TD><TD VALIGN="TOP" ALIGN="LEFT"><A HREF="/problemset.aspx">Problem set</A><BR><A HREF="/submit.aspx">Submit solution</A><BR><A HREF="/status.aspx">Judge status</A><BR><A HREF="/help.aspx?topic=judge">Guide</A><BR></TD><TD VALIGN="TOP"><A HREF="/register.aspx">Register</A><BR><A HREF="/authedit.aspx">Update your info</A><BR><A HREF="/ranklist.aspx">Authors ranklist</A><BR><FORM ACTION="/search.aspx" METHOD="GET" STYLE="margin-top:0.6em;"><INPUT NAME="Str" SIZE="12" VALUE="" PLACEHOLDER="Author’s name"> <INPUT TYPE="SUBMIT" VALUE="Search"></FORM></TD><TD VALIGN="TOP"><A HREF="/contest.aspx">Current contest</A><BR><A HREF="/schedule.aspx">Scheduled contests</A><BR><A HREF="/archive.aspx">Past contests</A><BR><A HREF="/help.aspx?topic=contest">Rules</A><BR></TD></TR></TABLE></TD></TR></TABLE></TD></TR><TR><TD STYLE="padding-top: 32px; padding-bottom: 20px;"><TABLE ALIGN="CENTER" CELLSPACING="0" CELLPADDING="0"><TR><TD WIDTH="800"><DIV CLASS="problem_content"><H2 class="problem_title">2128. Rubina's Solitaire</H2><DIV class="problem_limits">Time limit: 1.0 second<BR>Memory limit: 128 MB<BR></DIV><DIV ID="problem_text"><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">In the evenings Rubina likes to play solitaire. To play the game she uses a family card deck. In the Rubina’s deck there are <i>m</i>&nbsp;&middot;&nbsp;<i>n</i> cards, each of which has one of <i>m</i> suits and a rank from 1 to <i>n</i>. There are no two cards of the same suit and rank simultaneously in the card deck.</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">To solve this solitaire means to lay out all the cards into <i>m</i> stacks so that all cards in each stack are of the same suit and follow from the bottom up in order of increasing rank. The solitaire begins with Rubina shuffling cards and laying them down in <i>k</i> horizontal rows where the <i>i</i>-th row consists of <i>a</i><sub><i>i</i></sub> cards. For one move it is allowed to take the rightmost card from any row and move it to the stack with the same suit as the card has. The move is possible only if the top card in this stack is one less with its rank than the card that was moved, or if the stack is empty and the card that was moved has a rank of 1.
</DIV></DIV><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">Rubina has already shuffled the cards and put them into the rows. Find out if she will be able to solve the solitaire.</DIV></DIV><H3 CLASS="problem_subtitle">Input</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">The first line contains the integers <i>m</i>, <i>n</i> and <i>k</i> that are the number of suits, the number of cards in the suit and the number of rows, respectively (1 &le; <i>n</i> &middot; <i>m</i> &le; 10<sup>5</sup>; 1 &le; <i>k</i> &le; 10<sup>5</sup>). Each of the following <i>k</i> lines contains a description of the next row of cards. The description of <i>i</i>-th row begins with a positive integer <i>a</i><sub><i>i</i></sub> that is the number of cards in this row. After that in the line with the row description <i>a</i><sub><i>i</i></sub> pairs of integers <i>b</i><sub><i>ij</i></sub>, <i>c</i><sub><i>ij</i></sub> are listed that are the suit and rank of the card lying in the <i>i</i>-th row at position <i>j</i> from left to right (1 &le; <i>b</i><sub><i>ij</i></sub> &le; <i>m</i>; 1 &le; <i>c</i><sub><i>ij</i></sub> &le; <i>n</i>). It is guaranteed that all the cards at the beginning are different and form the Rubina’s deck.</DIV></DIV><H3 CLASS="problem_subtitle">Output</H3><DIV CLASS="problem_par"><DIV CLASS="problem_par_normal">If the solitaire can not be solved, output &ldquo;NO&rdquo;. Otherwise, output &ldquo;YES&rdquo; in the first line, and in the following <i>n</i> &middot; <i>m</i> lines output the card descriptions in the order they are transferred to the stacks. The description of the card must consists of two integers with a space between them: its suit and rank. If there are several different orders that  satisfy the problem requirements, you may output any of them.</DIV></DIV><H3 CLASS="problem_subtitle">Samples</H3><TABLE CLASS="sample"><TR><TH WIDTH="350">input</TH><TH WIDTH="350">output</TH></TR><TR><TD><PRE>2 3 2
3 1 3 2 3 1 1
3 1 2 2 2 2 1
</PRE></TD><TD><PRE>YES
1 1
2 1
2 2
2 3
1 2
1 3
</PRE></TD></TR><TR><TD><PRE>2 3 2
3 1 3 2 2 1 2
3 1 1 2 3 2 1
</PRE></TD><TD><PRE>NO
</PRE></TD></TR></TABLE><DIV CLASS="problem_source"><B>Problem Author: </B>Alexander Ipatov, prepared by Oleg Dolgorukov<BR></DIV></DIV></DIV><DIV><B>Tags: </B><A HREF="problemset.aspx?space=1&amp;tag=graphs">graph theory</A>  <SPAN CLASS="problem_tags_toggle">(<FORM METHOD="POST" ACTION="problem.aspx?space=1&amp;num=2128" STYLE="display:inline;" ID="ToggleTagsForm"><A HREF="problem.aspx?space=1&amp;num=2128" ONCLICK="document.getElementById('ToggleTagsForm').submit();return false;"><INPUT TYPE="hidden" NAME="Action" VALUE="HideTags">hide tags for unsolved problems</A></FORM>)</SPAN></DIV><DIV CLASS="problem_links"><SPAN>Difficulty: 815</SPAN>    <A HREF="print.aspx?space=1&amp;num=2128" TARGET="_blank">Printable version</A>    <A HREF="submit.aspx?space=1&amp;num=2128">Submit solution</A>    <A HREF="forum/?space=1&amp;num=2128">Discussion (0)</A><BR><A HREF="status.aspx?space=1&amp;num=2128">All submissions (468)</A>    <A HREF="status.aspx?space=1&amp;num=2128&amp;status=accepted">All accepted submissions (129)</A>    <A HREF="rating.aspx?space=1&amp;num=2128">Solutions rating (69)</A></DIV></TD></TR></TABLE></TD></TR><TR><TD CLASS="footer"><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter20918869 = new Ya.Metrika({ id:20918869, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="https://mc.yandex.ru/watch/20918869" style="position:absolute; left:-9999px;" alt=""></div></noscript>© 2000–2020 <A HREF="/team.aspx">Timus Online Judge Team</A>. All rights reserved.</TD></TR></TABLE></BODY></HTML>